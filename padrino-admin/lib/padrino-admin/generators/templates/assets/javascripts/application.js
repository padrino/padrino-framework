// Generated by CoffeeScript 1.3.3

jQuery(function() {
  var openModal, pBody, pClose, pFooter, pHeader, pModal, pTitle, prepareModalForm;
  pModal = $('#padrino-modal');
  pHeader = $('#padrino-modal-header');
  pTitle = $('#padrino-modal-title');
  pBody = $('#padrino-modal-body');
  pClose = $('#padrino-modal-close');
  pFooter = $('#padrino-modal-footer');
  openModal = function(source, title_tag, type, closed, objects_move, title_remove, hide_remove, html, center) {
    var obj, _i, _len;
    if (title_tag == null) {
      title_tag = 'h4';
    }
    if (type == null) {
      type = 'warning';
    }
    if (closed == null) {
      closed = 'Close';
    }
    if (objects_move == null) {
      objects_move = [];
    }
    if (title_remove == null) {
      title_remove = false;
    }
    if (hide_remove == null) {
      hide_remove = true;
    }
    if (html == null) {
      html = false;
    }
    if (center == null) {
      center = false;
    }
    pModal.addClass("flash-" + type);
    pHeader.addClass("alert-" + type);
    if (hide_remove) {
      $(source).find('.hide').removeClass('hide');
    }
    pTitle.append("" + type);
    if (title_remove) {
      $(source).find(title_tag).remove();
    }
    pModal.addClass("flash-" + type);
    if (html != null) {
      pBody.append($(source).html());
    } else {
      pBody.append($(source));
    }
    if (center) {
      pBody.addClass('pagination-centered');
    }
    for (_i = 0, _len = objects_move.length; _i < _len; _i++) {
      obj = objects_move[_i];
      $('#padrino-modal-footer').append($("#padrino-modal-body " + obj));
    }
    pClose.html(closed);
    return pModal.modal('show');
  };
  $('.invalid').parent().each(function() {
    return $(this).parent().addClass('error');
  });
  if ($('#field-errors').length) {
    openModal('#field-errors', 'h4', "error", 'Close');
  }
  if ($('#flash-result').length) {
    openModal('#flash-result', 'h4', $('#flash-result').attr('class'), 'Close');
  }
  $('#padrino-modal').on('hide', function() {
    var btn, type, types, _i, _len;
    types = ['success', 'notice', 'danger', 'error', 'info', 'warning'];
    pModal.unwrap();
    pTitle.empty();
    pHeader.removeClass("alert");
    for (_i = 0, _len = types.length; _i < _len; _i++) {
      type = types[_i];
      pHeader.removeClass("alert-" + type);
      pModal.removeClass("flash-" + type);
    }
    pBody.empty().removeClass('pagination-centered');
    btn = pClose.clone().removeClass('hide');
    pFooter.empty().append(btn);
    return pClose.empty();
  });
  prepareModalForm = function(data) {
    var form, pForm;
    form = $(data.form).clone();
    pModal.wrap("<form id='padrino-modal-form' />");
    pForm = $('#padrino-modal-form');
    pForm.attr('action', form.attr('action'));
    if (form.attr('method')) {
      pForm.attr('method', form.attr('method'));
    }
    form.prepend("<h4>" + data.title + "</h4>");
    return openModal(form, 'h4', data.type, null, [':input:submit', 'a'], false, false, true, true);
  };
  $(".btn_delete").click(function() {
    return prepareModalForm($(this).data());
  });
  $('#btn_multiple_delete').click(function() {
    $('#multiple_delete_form :checkbox').remove();
    $('#multiple_delete_form').append($('#multiple_list :checkbox:checked').clone());
    $('#multiple_delete_form :checkbox').attr('checked', 'checked');
    $('#multiple_delete_form :checkbox').addClass('hide');
    if ($('#multiple_delete_form :checkbox:checked').length > 0) {
      return prepareModalForm($(this).data());
    }
  });
  $('.to_submit').click(function() {
    return $(this).parent('form:first').submit();
  });
  $('#check_all').click(function() {
    return $('#multiple_list :checkbox').attr('checked', 'checked');
  });
  return $('#uncheck_all').click(function() {
    return $('#multiple_list :checkbox').removeAttr('checked');
  });
});
