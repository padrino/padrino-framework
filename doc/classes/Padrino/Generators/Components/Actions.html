<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Padrino::Generators::Components::Actions</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <table width="100%" border='0' cellpadding='0' cellspacing='0' class='banner'>
        <tr>
            <td class="file-title"><span class="file-title-prefix">Module</span><br />Padrino::Generators::Components::Actions</td>
            <td align="right">
                <table cellspacing="0" cellpadding="2">
                    <tr valign="top">
                        <td>In:</td>
                        <td>
                            
                            <a href="../../../../files/padrino-gen/lib/padrino-gen/generators/components/actions_rb.html">padrino-gen/lib/padrino-gen/generators/components/actions.rb</a>
                            
                        </td>
                    </tr>
                    
                </table>
            </td>
        </tr>
    </table>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <ul>
        
        <li><a href="#M000263">controller_actions</a></li>
        
        <li><a href="#M000262">indent_spaces</a></li>
        
        <li><a href="#M000261">insert_mocking_include</a></li>
        
        <li><a href="#M000260">insert_test_suite_setup</a></li>
        
        <li><a href="#M000258">migration_exist?</a></li>
        
        <li><a href="#M000256">output_migration_file</a></li>
        
        <li><a href="#M000255">output_model_migration</a></li>
        
        <li><a href="#M000259">remove_migration</a></li>
        
        <li><a href="#M000257">return_last_migration_number</a></li>
        
    </ul>
    

    

    

    

    

    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000263"></a><b>controller_actions</b>(fields)
                    
                </div>
                
                <div class="description">
                  
                  <p>
For <a href="../Controller.html">Controller</a> action generation Takes in
fields for routes in the form of get:index post:test delete:yada and such
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000263_source')" id="l_M000263_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L110" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000263_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 110</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">controller_actions</span>(<span class="ruby-identifier">fields</span>)
          <span class="ruby-identifier">field_tuples</span> = <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;:&quot;</span>) }
          <span class="ruby-identifier">action_declarations</span> = <span class="ruby-identifier">field_tuples</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">request</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
            <span class="ruby-node">&quot;#{request} :#{name} do\n  end\n&quot;</span>
          <span class="ruby-keyword kw">end</span>
          <span class="ruby-identifier">action_declarations</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n  &quot;</span>)
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000262"></a><b>indent_spaces</b>(count)
                    
                </div>
                
                <div class="description">
                  
                  <p>
Returns space characters of given count <a
href="Actions.html#M000262">indent_spaces</a>(2)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000262_source')" id="l_M000262_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L104" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000262_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 104</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">indent_spaces</span>(<span class="ruby-identifier">count</span>)
          <span class="ruby-value str">' '</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">count</span>
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000261"></a><b>insert_mocking_include</b>(library_name, options={})
                    
                </div>
                
                <div class="description">
                  
                  <p>
For mocking components Injects the mock library include into the test class
in test_config for setting up mock gen
insert_mock_library_include(&#8216;Mocha::API&#8217;)
</p>
<h1>> inject_into_file(&#8220;test/test_config.rb&#8220;, &#8220; include Mocha::APIn&#8220;, :after => /class.*?n/)</h1>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000261_source')" id="l_M000261_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L95" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000261_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 95</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert_mocking_include</span>(<span class="ruby-identifier">library_name</span>, <span class="ruby-identifier">options</span>={})
          <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reverse_merge!</span>(<span class="ruby-identifier">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">:after</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/class.*?\n/</span>, <span class="ruby-identifier">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;test/test_config.rb&quot;</span>)
          <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">destination_root</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:path</span>]))
          <span class="ruby-identifier">include_text</span> = <span class="ruby-identifier">indent_spaces</span>(<span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;include #{library_name}\n&quot;</span>
          <span class="ruby-identifier">inject_into_file</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:path</span>], <span class="ruby-identifier">include_text</span>, <span class="ruby-identifier">:after</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:after</span>])
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000260"></a><b>insert_test_suite_setup</b>(suite_text, options={})
                    
                </div>
                
                <div class="description">
                  
                  <p>
For testing components Injects the test class text into the test_config
file for setting up the test gen <a
href="Actions.html#M000260">insert_test_suite_setup</a>(&#8217;&#8230;CLASS_NAME&#8230;&#8217;)
</p>
<h1>> inject_into_file(&#8220;test/test_config.rb&#8220;, TEST.gsub(/CLASS_NAME/, @app_name), :after => &#8220;set :environment, :test&#8221;)</h1>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000260_source')" id="l_M000260_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L86" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000260_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 86</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert_test_suite_setup</span>(<span class="ruby-identifier">suite_text</span>, <span class="ruby-identifier">options</span>={})
          <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reverse_merge!</span>(<span class="ruby-identifier">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;test/test_config.rb&quot;</span>)
          <span class="ruby-identifier">create_file</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:path</span>], <span class="ruby-identifier">suite_text</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/CLASS_NAME/</span>, <span class="ruby-ivar">@app_name</span>))
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000258"></a><b>migration_exist?</b>(filename)
                    
                </div>
                
                <div class="description">
                  
                  <p>
Return true if the migration already exist
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000258_source')" id="l_M000258_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L66" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000258_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 66</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">migration_exist?</span>(<span class="ruby-identifier">filename</span>)
          <span class="ruby-constant">Dir</span>[<span class="ruby-identifier">destination_root</span>(<span class="ruby-node">&quot;db/migrate/*_#{filename.underscore}.rb&quot;</span>)].<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000256"></a><b>output_migration_file</b>(filename, name, columns, options={})
                    
                </div>
                
                <div class="description">
                  
                  <p>
For orm database components Generates a standalone migration file based on
the given options and columns options => { :base
&#8220;&#8230;text...&#8220;, :change_format =>
&#8220;&#8230;text...&#8220;,
</p>
<pre>
             :add =&gt; proc { |field, kind| &quot;add_column :#{table_name}, :#{field}, :#{kind}&quot; },
             :remove =&gt; proc { |field, kind| &quot;remove_column :#{table_name}, :#{field}&quot; }
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000256_source')" id="l_M000256_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L33" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000256_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 33</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">output_migration_file</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>={})
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">behavior</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:revoke</span>
            <span class="ruby-identifier">remove_migration</span>(<span class="ruby-identifier">name</span>)
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">migration_exist?</span>(<span class="ruby-identifier">filename</span>)
            <span class="ruby-identifier">change_format</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:change_format</span>]
            <span class="ruby-identifier">migration_scan</span> = <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">camelize</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/(Add|Remove)(?:.*?)(?:To|From)(.*?)$/</span>).<span class="ruby-identifier">flatten</span>
            <span class="ruby-identifier">direction</span>, <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">migration_scan</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">downcase</span>, <span class="ruby-identifier">migration_scan</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">pluralize</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">migration_scan</span>.<span class="ruby-identifier">any?</span>
            <span class="ruby-identifier">tuples</span> = <span class="ruby-identifier">direction</span> <span class="ruby-value">? </span><span class="ruby-identifier">columns</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;:&quot;</span>) } <span class="ruby-operator">:</span> []
            <span class="ruby-identifier">tuples</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">field</span>, <span class="ruby-identifier">kind</span><span class="ruby-operator">|</span> <span class="ruby-identifier">kind</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/datetime/i</span> <span class="ruby-operator">?</span> [<span class="ruby-identifier">field</span>, <span class="ruby-value str">'DateTime'</span>] <span class="ruby-operator">:</span> [<span class="ruby-identifier">field</span>, <span class="ruby-identifier">kind</span>] } <span class="ruby-comment cmt"># fix datetime</span>
            <span class="ruby-identifier">add_columns</span>    = <span class="ruby-identifier">tuples</span>.<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:add</span>]).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n    &quot;</span>)
            <span class="ruby-identifier">remove_columns</span> = <span class="ruby-identifier">tuples</span>.<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:remove</span>]).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n    &quot;</span>)
            <span class="ruby-identifier">forward_text</span> = <span class="ruby-identifier">change_format</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!TABLE!/</span>, <span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!COLUMNS!/</span>, <span class="ruby-identifier">add_columns</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tuples</span>.<span class="ruby-identifier">any?</span>
            <span class="ruby-identifier">back_text</span>    = <span class="ruby-identifier">change_format</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!TABLE!/</span>, <span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!COLUMNS!/</span>, <span class="ruby-identifier">remove_columns</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tuples</span>.<span class="ruby-identifier">any?</span>
            <span class="ruby-identifier">contents</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:base</span>].<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\s{4}!UP!\n/</span><span class="ruby-identifier">m</span>,   (<span class="ruby-identifier">direction</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'add'</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">forward_text</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">back_text</span>.<span class="ruby-identifier">to_s</span>))
            <span class="ruby-identifier">contents</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\s{4}!DOWN!\n/</span><span class="ruby-identifier">m</span>, (<span class="ruby-identifier">direction</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'add'</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">back_text</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">forward_text</span>.<span class="ruby-identifier">to_s</span>))
            <span class="ruby-identifier">contents</span> = <span class="ruby-identifier">contents</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!FILENAME!/</span>, <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">underscore</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!FILECLASS!/</span>, <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">camelize</span>)
            <span class="ruby-identifier">current_migration_number</span> = <span class="ruby-identifier">return_last_migration_number</span>
            <span class="ruby-identifier">contents</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/!VERSION!/</span>, (<span class="ruby-identifier">current_migration_number</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">to_s</span>)
            <span class="ruby-identifier">migration_filename</span> = <span class="ruby-node">&quot;#{format(&quot;%03d&quot;, current_migration_number+1)}_#{filename.underscore}.rb&quot;</span>
            <span class="ruby-identifier">create_file</span>(<span class="ruby-identifier">destination_root</span>(<span class="ruby-value str">'db/migrate/'</span>, <span class="ruby-identifier">migration_filename</span>), <span class="ruby-identifier">contents</span>, <span class="ruby-identifier">:skip</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000255"></a><b>output_model_migration</b>(filename, name, columns, options={})
                    
                </div>
                
                <div class="description">
                  
                  <p>
For orm database components Generates the model migration file created when
generating a new model options => { :base => &#8220;.&#8230;text...&#8220;,
:up => &#8220;..text...&#8220;,
</p>
<pre>
            :down =&gt; &quot;..text...&quot;, column_format =&gt; &quot;t.column :#{field}, :#{kind}&quot; }
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000255_source')" id="l_M000255_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L9" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000255_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 9</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">output_model_migration</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>={})
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">behavior</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:revoke</span>
            <span class="ruby-identifier">remove_migration</span>(<span class="ruby-identifier">filename</span>)
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">migration_exist?</span>(<span class="ruby-identifier">filename</span>)
            <span class="ruby-identifier">model_name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">pluralize</span>
            <span class="ruby-identifier">field_tuples</span> = <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;:&quot;</span>) }
            <span class="ruby-identifier">field_tuples</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">field</span>, <span class="ruby-identifier">kind</span><span class="ruby-operator">|</span> <span class="ruby-identifier">kind</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/datetime/i</span> <span class="ruby-operator">?</span> [<span class="ruby-identifier">field</span>, <span class="ruby-value str">'DateTime'</span>] <span class="ruby-operator">:</span> [<span class="ruby-identifier">field</span>, <span class="ruby-identifier">kind</span>] } <span class="ruby-comment cmt"># fix datetime</span>
            <span class="ruby-identifier">column_declarations</span> = <span class="ruby-identifier">field_tuples</span>.<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:column_format</span>]).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n      &quot;</span>)
            <span class="ruby-identifier">contents</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:base</span>].<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\s{4}!UP!\n/</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:up</span>]).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!DOWN!\n/</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:down</span>])
            <span class="ruby-identifier">contents</span> = <span class="ruby-identifier">contents</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!NAME!/</span>, <span class="ruby-identifier">model_name</span>.<span class="ruby-identifier">camelize</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!TABLE!/</span>, <span class="ruby-identifier">model_name</span>.<span class="ruby-identifier">underscore</span>)
            <span class="ruby-identifier">contents</span> = <span class="ruby-identifier">contents</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!FILENAME!/</span>, <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">underscore</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!FILECLASS!/</span>, <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">camelize</span>)
            <span class="ruby-identifier">current_migration_number</span> = <span class="ruby-identifier">return_last_migration_number</span>
            <span class="ruby-identifier">contents</span> = <span class="ruby-identifier">contents</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!FIELDS!/</span>, <span class="ruby-identifier">column_declarations</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/!VERSION!/</span>, (<span class="ruby-identifier">current_migration_number</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">to_s</span>)
            <span class="ruby-identifier">migration_filename</span> = <span class="ruby-node">&quot;#{format(&quot;%03d&quot;, current_migration_number+1)}_#{filename.underscore}.rb&quot;</span>
            <span class="ruby-identifier">create_file</span>(<span class="ruby-identifier">destination_root</span>(<span class="ruby-value str">'db/migrate/'</span>, <span class="ruby-identifier">migration_filename</span>), <span class="ruby-identifier">contents</span>, <span class="ruby-identifier">:skip</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000259"></a><b>remove_migration</b>(name)
                    
                </div>
                
                <div class="description">
                  
                  <p>
For the removal of migration files removes the migration file based on the
migration name
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000259_source')" id="l_M000259_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L72" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000259_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 72</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_migration</span>(<span class="ruby-identifier">name</span>)
          <span class="ruby-identifier">migration_path</span> =  <span class="ruby-constant">Dir</span>[<span class="ruby-identifier">destination_root</span>(<span class="ruby-value str">'db/migrate/*.rb'</span>)].<span class="ruby-identifier">find</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
            <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">f</span>) <span class="ruby-operator">=~</span> <span class="ruby-node">/#{name.to_s.underscore}/</span>
          <span class="ruby-keyword kw">end</span>
          <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">migration_path</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">behavior</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:revoke</span>
            <span class="ruby-identifier">create_file</span> <span class="ruby-identifier">migration_path</span> <span class="ruby-comment cmt"># we use create to reverse the operation of a revoke</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000257"></a><b>return_last_migration_number</b>()
                    
                </div>
                
                <div class="description">
                  
                  <p>
For migration files returns the number of the latest(most current)
migration file
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000257_source')" id="l_M000257_source">show</a>
                        
                        | <a href="http://github.com/lenzcom/padrino-framework/blob/5b6b203790ecdd602cf1163719925cc9f18bba19/padrino-gen/lib/padrino-gen/generators/components/actions.rb#L59" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000257_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File padrino-gen/lib/padrino-gen/generators/components/actions.rb, line 59</span>
        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">return_last_migration_number</span>
          <span class="ruby-constant">Dir</span>[<span class="ruby-identifier">destination_root</span>(<span class="ruby-value str">'db/migrate/*.rb'</span>)].<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
            <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">f</span>).<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/^(\d+)/</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
          }.<span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">||</span> <span class="ruby-value">0</span>
        <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    